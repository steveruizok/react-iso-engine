(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{15:function(e,t,o){e.exports=o(26)},20:function(e,t,o){},22:function(e,t,o){},26:function(e,t,o){"use strict";o.r(t);var n=o(0),r=o.n(n),i=o(8),s=o.n(i),a=(o(20),o(2)),c=o(3),u=o(6),l=o(4),h=o(7),f=(o(22),o(5)),p={color:"grey"},v=function e(t,o){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:p;Object(a.a)(this,e),this.color=void 0,this.faces=[],this.busy=!1,this.silhouette="",this.outline="",this.edge="",this.adjacent={north:void 0,east:void 0,south:void 0,west:void 0,above:void 0,below:void 0},this.position=void 0,this.size=void 0,this.blocksBehind=[],this.blocksInFront=[],this.moveTo=function(e){n.position=e},this.resizeTo=function(e){n.size=e},this.position=t,this.size=o,this.color=r.color},d=function(){function e(t,o){Object(a.a)(this,e),this.origin=void 0,this.scale=void 0,this.origin=t,this.scale=o}return Object(c.a)(e,[{key:"spaceToIso",value:function(e){var t=e.x,o=e.y,n=e.z;return{x:t+=n,y:o+=n,h:(t-o)*Math.sqrt(3)/2,v:(t+o)/2}}},{key:"isoToScreen",value:function(e){var t=e.h,o=e.v;return{x:t*this.scale+this.origin.x,y:-o*this.scale+this.origin.y}}},{key:"spaceToScreen",value:function(e){return this.isoToScreen(this.spaceToIso(e))}},{key:"screenToIso",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.x-=this.origin.x+e.z,e.y-=this.origin.y+e.z;var o=this.scale,n=1.732*this.scale,r=(-e.x/(n/2)-e.y/(o/2))/2,i=(-e.y/(o/2)+e.x/(n/2))/2;return t&&(i=Math.floor(i),r=Math.floor(r)),{x:i,y:r,h:-(i-r)*Math.sqrt(3)/2,v:(i+r)/2}}},{key:"getBounds",value:function(e){var t=e.position,o=t.x,n=t.y,r=t.z,i=e.size;return{minX:o,maxX:o+i.x,minY:n,maxY:n+i.y,minZ:r,maxZ:r+i.z}}},{key:"getIsoBounds",value:function(e){var t=this.getIsoVerts(e),o=t.frontDown,n=t.backUp,r=t.leftDown,i=t.rightDown;return{minX:o.x,maxX:n.x,minY:o.y,maxY:n.y,minH:r.h,maxH:i.h}}},{key:"getIsoNamedSpaceVerts",value:function(e){var t=e.position,o=t.x,n=t.y,r=t.z,i=e.size,s=i.x,a=i.y,c=i.z;return{rightDown:{x:o+s,y:n,z:r},leftDown:{x:o,y:n+a,z:r},backDown:{x:o+s,y:n+a,z:r},frontDown:{x:o,y:n,z:r},rightUp:{x:o+s,y:n,z:r+c},leftUp:{x:o,y:n+a,z:r+c},backUp:{x:o+s,y:n+a,z:r+c},frontUp:{x:o,y:n,z:r+c}}}},{key:"getIsoVerts",value:function(e){var t=this,o=this.getIsoNamedSpaceVerts(e);return Object.keys(o).reduce(function(e,n){return e[n]=t.spaceToIso(o[n]),e},{})}},{key:"getScreenVerts",value:function(e){var t=this,o=this.getIsoNamedSpaceVerts(e);return Object.keys(o).reduce(function(e,n){return e[n]=t.spaceToScreen(o[n]),e},{})}},{key:"areRangesDisjoint",value:function(e,t,o,n){return t<=o||n<=e}},{key:"doBlocksOverlap",value:function(e,t){return null!==this.getIsoSepAxis(e,t)}},{key:"doBlocksIntersect",value:function(e,t){return null===this.getSpaceSepAxis(e,t)}},{key:"getSpaceSepAxis",value:function(e,t){var o=this.getBounds(e),n=this.getBounds(t);return this.areRangesDisjoint(o.minX,o.maxX,n.minX,n.maxX)?"x":this.areRangesDisjoint(o.minY,o.maxY,n.minY,n.maxY)?"y":this.areRangesDisjoint(o.minZ,o.maxZ,n.minZ,n.maxZ)?"z":null}},{key:"getIsoSepAxis",value:function(e,t){var o=this.getIsoBounds(e),n=this.getIsoBounds(t);return this.areRangesDisjoint(o.minX,o.maxX,n.minX,n.maxX)?"x":this.areRangesDisjoint(o.minY,o.maxY,n.minY,n.maxY)?"y":this.areRangesDisjoint(o.minH,o.maxH,n.minH,n.maxH)?"h":null}},{key:"getFrontBlock",value:function(e,t){if(!this.getSpaceSepAxis(e,t))return null;var o=[this.getBounds(e),this.getBounds(t)],n=o[0],r=o[1];switch(this.getSpaceSepAxis(e,t)){case"x":return n.minX<r.minX?e:t;case"y":return n.minY<r.minY?e:t;case"z":return n.minZ<r.minZ?t:e;default:throw"Blocks must be non-intersecting!"}}}]),e}(),k=o(10),y=o(14),g=o(9);function m(e){return Object(k.a)(Array(e)).map(function(e,t){return t})}function b(e,t){e.splice(e.indexOf(t),1)}function x(e){return"".concat(e.x,",").concat(e.y," ")}function w(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return"M ".concat(x(e[0])," L ").concat(e.slice(1).map(function(e){return x(e)})," ").concat(t?"Z":"")}var z,B=o(13),j={origin:function(e,t){return{x:e/2,y:t/2}},scale:32,blocks:[]},O=function(){function e(){var t=this,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(a.a)(this,e),this.blocks=void 0,this.sorted=[],this.camera=void 0,this.painter=void 0,this.hovered=void 0,this.selected=void 0,this.cursor=void 0,this.setHovered=function(e){t.hovered=e},this.animateBlock=function(e,o,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:360;e.busy||(e.busy=!0,Object(B.a)(Object(y.a)({targets:e[o],easing:"easeOutQuad",duration:r,update:function(){t.renderBlock(e),t.sort()},complete:function(){e.busy=!1}},n)))},this.moveBlock=function(e,o){var n,r=e.position,i=r.x,s=r.y,a=r.z;switch(o){case"north":n={x:i+1,y:s,z:a};break;case"east":n={x:i,y:s-1,z:a};break;case"south":n={x:i-1,y:s,z:a};break;case"west":n={x:i,y:s+1,z:a};break;default:n={x:i,y:s,z:a}}var c=t.getBlocks(n),u=Object(g.maxBy)(c,function(e){return e.position.z});u&&(n.z=u.position.z+u.size.z,t.animateBlock(e,"position",n))},this.renderBlock=function(e){return Object.assign(e,{edge:t.painter.getEdge(e),faces:t.painter.getFaces(e),silhouette:t.painter.getSilhouette(e),outline:t.painter.getOutline(e)}),e},this.render=function(){return t.sortBlocks(t.blocks).map(t.renderBlock)},this.getBlockAtIso=function(e){var o=e.x,n=e.y,r=e.z;return o=Math.floor(o),n=Math.floor(n),r=Math.floor(r),t.blocks.find(function(e){var t=e.position,i=t.x,s=t.y,a=t.z;return o===i&&n===s&&r===a})},this.getBlocks=function(e){var o=e.x,n=e.y,r=e.z;return o=Math.floor(o),n=Math.floor(n),r=Math.floor(r),Object(g.sortBy)(t.blocks.filter(function(e){var t=e.position,r=t.x,i=t.y;return o===r&&n===i}),"position.z")},this.setCursor=function(e){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:1,y:1,z:1};e?(t.cursor=new v(e,o),t.renderBlock(t.cursor)):t.cursor=void 0};var n=o.height,r=o.width,i=o.origin,s=void 0===i?j.origin:i,c=o.scale,u=void 0===c?j.scale:c,l=o.blocks,h=void 0===l?j.blocks:l;this.camera=new d(s(n,r),u),this.painter=new S(this.camera),this.blocks=h,this.sort(),this.render()}return Object(c.a)(e,[{key:"sort",value:function(){this.sorted=this.getSorted()}},{key:"getSorted",value:function(){return this.sortBlocks(this.blocks)}},{key:"addBlocks",value:function(e){return Array.isArray(e)?this.blocks=this.blocks.concat(e):this.blocks=[].concat(Object(k.a)(this.blocks),[e]),this.render(),this.blocks}},{key:"removeBlock",value:function(e){if(Array.isArray(e)){var t=!0,o=!1,n=void 0;try{for(var r,i=e[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var s=r.value;b(this.blocks,s)}}catch(a){o=!0,n=a}finally{try{t||null==i.return||i.return()}finally{if(o)throw n}}}else b(this.blocks,e);return this.blocks}},{key:"sortBlocks",value:function(e){var t,o,n,r,i,s=this,a=e.length;for(t=0;t<a;t++)e[t].blocksBehind=[],e[t].blocksInFront=[];for(t=0;t<a;t++)for(n=e[t],o=t+1;o<a;o++)r=e[o],(i=this.camera.getFrontBlock(n,r))&&(n===i?(n.blocksBehind.push(r),r.blocksInFront.push(n)):(r.blocksBehind.push(n),n.blocksInFront.push(r)));var c=[];for(t=0;t<a;t++)0===e[t].blocksBehind.length&&c.push(e[t]);for(var u=[];c.length>0;){var l=c.pop();if(!l)return u;for(u.push(l),o=0;o<l.blocksInFront.length;o++){var h=l.blocksInFront[o];b(h.blocksBehind,l),0===h.blocksBehind.length&&c.push(h)}}return u.forEach(function(e){e.adjacent=s.getAdjacentBlocks(e)}),u}},{key:"getAdjacentBlocks",value:function(e){var t=e.position,o=t.x,n=t.y,r=t.z;return{north:this.getBlockAtIso({x:o+1,y:n,z:r}),west:this.getBlockAtIso({x:o,y:n+1,z:r}),above:this.getBlockAtIso({x:o,y:n,z:r+1}),south:this.getBlockAtIso({x:o-1,y:n,z:r}),east:this.getBlockAtIso({x:o,y:n-1,z:r}),below:this.getBlockAtIso({x:o,y:n,z:r-1})}}}]),e}(),S=function(){function e(t){Object(a.a)(this,e),this.camera=void 0,this.camera=t}return Object(c.a)(e,[{key:"getEdge",value:function(e){var t=this.camera.getScreenVerts(e),o=e.adjacent,n=o.north,r=o.east,i=o.south,s=o.west,a=o.above,c=o.below,u="",l="";return n||a||(l+=w([t.backUp,t.rightUp],!1)),n||r||(l+=w([t.rightUp,t.rightDown],!1)),r||c||(l+=w([t.rightDown,t.frontDown],!1)),s||a||(u+=w([t.backUp,t.leftUp],!1)),s||i||(u+=w([t.leftUp,t.leftDown],!1)),i||c||(u+=w([t.leftDown,t.frontDown],!1)),u+l}},{key:"getSilhouette",value:function(e){var t=this.camera.getScreenVerts(e);return w([t.frontDown,t.leftDown,t.leftUp,t.backUp,t.rightUp,t.rightDown])}},{key:"getFaces",value:function(e){var t=this.camera.getScreenVerts(e);return[[t.frontUp,t.leftUp,t.backUp,t.rightUp],[t.frontDown,t.leftDown,t.leftUp,t.frontUp],[t.frontDown,t.rightDown,t.rightUp,t.frontUp]].map(function(e){return w(e)})}},{key:"getOutline",value:function(e){var t=this.camera.getScreenVerts(e);return w([t.frontDown,t.leftDown,t.leftUp,t.backUp,t.rightUp,t.rightDown])+w([t.frontUp,t.frontDown])+w([t.frontUp,t.leftUp])+w([t.frontUp,t.rightUp])}}]),e}(),D=O,I={grey:["#AAA","#888","#777","#444","#222"],yellow:["#FFA","#FD8","#FA7","#F74","#F32"]},E=function(e){function t(){return Object(a.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.block,o=(e.point,e.onMouseEnter),n=e.onClick,i=t.color,s=t.faces,a=t.edge,c=(t.silhouette,"".concat(t.position.x,"_").concat(t.position.y,"_").concat(t.position.z)),u=I[i];return r.a.createElement("g",{onMouseEnter:o?function(e){o(t)}:void 0,onClick:n?function(){return n(t)}:void 0},s.map(function(e,t){var o=u[t];return r.a.createElement("path",{key:"block_".concat(c,"_face_").concat(t),d:e,stroke:"none",fill:o,strokeWidth:"1"})}),a&&r.a.createElement("path",{d:a,stroke:u[4],fill:"none",strokeWidth:.5}))}}]),t}(n.Component),C=Object(f.a)(E),U=function(e){function t(){return Object(a.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.iso.cursor;if(!e)return r.a.createElement("g",null);var t=e.silhouette;return r.a.createElement("g",{pointerEvents:"none"},r.a.createElement("path",{d:t,stroke:"none",fill:"rgba(109, 223, 255, .5)"}))}}]),t}(n.Component),A=Object(f.a)(U),M=function(e){function t(){return Object(a.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.iso,o=e.zCursor,n=t.camera,i=n.scale,s=n.origin,a=s.x,c=s.y;return r.a.createElement("g",{transform:"translate(".concat(a,", ").concat(c-o*i,")"),pointerEvents:"none"},r.a.createElement("path",{d:"M -8,8 L 8,8 0,0",stroke:"none",fill:"rgba(109, 223, 255, .5)"}),r.a.createElement("text",{x:0,y:24,textAnchor:"middle",fontSize:12,fontWeight:"bold",fill:"rgba(109, 223, 255, .5)"},o))}}]),t}(n.Component),T=Object(f.a)(M),F=o(1);Object(F.g)(D,{sorted:F.l,addBlocks:F.d,hovered:F.l,cursor:F.l,setHovered:F.d,moveBlock:F.d,selected:F.l,sort:F.d}),Object(F.g)(v,{position:F.l,size:F.l,silhouette:F.l,faces:F.l,moveTo:F.d.bound,resizeTo:F.d.bound}),z=[],(z=m(10).map(function(e){return m(10).map(function(t){return new v({x:t,y:e,z:0},{x:1,y:1,z:1})})}).flat()).push(new v({x:5,y:5,z:1},{x:1,y:1,z:1}));var _=new v({x:.25,y:.25,z:1},{x:.5,y:.5,z:1.6},{color:"yellow"});z.push(_);var X=new D({height:600,width:400,scale:20,origin:function(e,t){return{x:t/2,y:.75*e}},blocks:z});X.selected=_;var Y=X,V=function(e){function t(){var e,o;Object(a.a)(this,t);for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return(o=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(i)))).container=r.a.createRef(),o.mousePoint={x:0,y:0},o.state={showCursor:!1,zCursor:0,blocks:[]},o.handleClick=function(e){var t=o.pointToIso(o.mousePoint);t&&o.createBlock(t)},o.handleMouseMove=function(e){o.mousePoint={x:e.pageX,y:e.pageY},o.setCursor(o.mousePoint,1===e.buttons)},o.setCursor=function(e,t){var n=o.state,r=n.showCursor,i=n.zCursor;if(r){var s=o.pointToIso(e);s&&(t&&o.createBlock(s),Y.setCursor({x:s.x,y:s.y,z:i}))}},o}return Object(h.a)(t,e),Object(c.a)(t,[{key:"pointToIso",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=this.container.current,n=this.props.iso;if(o){var r={x:e.x-o.offsetLeft,y:e.y-o.offsetTop,z:this.state.zCursor};return n.camera.screenToIso(r,t)}}},{key:"componentWillMount",value:function(){var e=this;window.addEventListener("keypress",function(t){var o=e.state.zCursor,n={q:function(){return e.setState({zCursor:o-1})},e:function(){return e.setState({zCursor:o+1})},w:function(){return Y.selected&&Y.moveBlock(Y.selected,"north")},s:function(){return Y.selected&&Y.moveBlock(Y.selected,"south")},a:function(){return Y.selected&&Y.moveBlock(Y.selected,"west")},d:function(){return Y.selected&&Y.moveBlock(Y.selected,"east")}};try{n[t.key](),e.setCursor(e.mousePoint,!1)}catch(r){}})}},{key:"componentDidMount",value:function(){}},{key:"createBlock",value:function(e){var t=e.x,o=e.y,n=this.state.zCursor;Y.addBlocks(new v({x:t,y:o,z:n},{x:1,y:1,z:1}))}},{key:"render",value:function(){var e=this,t=this.props.iso,o=t.sorted,n=this.state,i=n.zCursor,s=n.showCursor,a={focus:[],lower:[],higher:[]};return s?o.reduce(function(e,t){return t.position.z<i?e.lower.push(t):t.position.z>i?e.higher.push(t):e.focus.push(t),e},a):a.focus=o,r.a.createElement("div",{className:"App"},r.a.createElement("div",{ref:this.container,style:{margin:"0 auto",height:600,width:400,position:"relative",cursor:"none"},onMouseEnter:function(){return e.setState({showCursor:!0})},onMouseLeave:function(){return e.setState({showCursor:!1},function(){return t.setCursor(null)})}},r.a.createElement("svg",{viewBox:"0,0,400,600",style:{position:"absolute",left:0,top:0,border:"1px solid #000",height:600,width:400},onMouseMove:this.handleMouseMove,onClick:this.handleClick},r.a.createElement("g",{key:"blocks_z_layer_lower",opacity:.45},a.lower.map(function(e,o){return r.a.createElement(C,{key:"block_".concat(o),block:e,point:t.camera.spaceToScreen(e.position)})})),r.a.createElement("g",{key:"blocks_z_layer_focused",opacity:1},a.focus.map(function(e,o){return r.a.createElement(C,{key:"block_".concat(o),block:e,point:t.camera.spaceToScreen(e.position)})})),r.a.createElement("g",{key:"blocks_z_layer_higher",opacity:.45},a.higher.map(function(e,o){return r.a.createElement(C,{key:"block_".concat(o),block:e,point:t.camera.spaceToScreen(e.position)})})),"))}",s&&r.a.createElement(r.a.Fragment,null,r.a.createElement(A,{iso:t}),r.a.createElement(T,{iso:t,zCursor:i})))))}}]),t}(n.Component);V.defaultProps={iso:Y};var Z=Object(f.a)(V);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(Z,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[15,2,1]]]);
//# sourceMappingURL=main.f3365103.chunk.js.map